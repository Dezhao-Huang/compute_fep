LAMMPS (11 May 2014)
# created by fftool

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
special_bonds lj/coul 0.0 0.0 0.5

read_data data.eq.lmp
  orthogonal box = (-9.36391 -9.36391 -9.36391) to (9.36391 9.36391 9.36391)
  1 by 1 by 2 MPI processor grid
  reading atoms ...
  649 atoms
  reading velocities ...
  649 velocities
  scanning bonds ...
  1 = max bonds/atom
  scanning angles ...
  1 = max angles/atom
  reading bonds ...
  432 bonds
  reading angles ...
  216 angles
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
# read_restart restart.*.lmp
# reset_timestep 0

pair_style hybrid lj/cut/coul/long 10.0 10.0
pair_modify tail yes
kspace_style pppm 1.0e-4

pair_coeff    1    1  lj/cut/coul/long    0.0028   2.7800  # Ne Ne
pair_coeff    1    2  lj/cut/coul/long    0.0000   1.0000  # Ne Hw
pair_coeff    1    3  lj/cut/coul/long    0.0208   2.9665  # Ne Ow
pair_coeff    2    2  lj/cut/coul/long    0.0000   1.0000  # Hw Hw
pair_coeff    2    3  lj/cut/coul/long    0.0000   1.0000  # Hw Ow
pair_coeff    3    3  lj/cut/coul/long    0.1554   3.1655  # Ow Ow

variable nsteps index 1000
variable nprint equal ${nsteps}/10
variable nprint equal 1000/10
variable ndump equal ${nsteps}/100
variable ndump equal 1000/100

variable temp equal 300.0
variable press equal 1.0

neighbor 2.0 bin

timestep 1.0

# velocity all create ${temp} 12345

fix fSHAKE all shake 0.0001 20 0 b 1 a 1
  0 = # of size 2 clusters
  0 = # of size 3 clusters
  0 = # of size 4 clusters
  216 = # of frozen angles

fix fNVT all nvt temp ${temp} ${temp} 100
fix fNVT all nvt temp 300 ${temp} 100
fix fNVT all nvt temp 300 300 100
# fix fNPT all npt temp ${temp} ${temp} 100 iso ${press} ${press} 500


# neon to sodium fep

variable lambda equal ramp(0.0,1.0)
variable sig13 equal 3.33*v_lambda+2.78*(1.0-v_lambda)
variable q1 equal v_lambda

variable dlambda equal 0.1
variable dsig13 equal 3.33*v_dlambda-2.78*v_dlambda
variable dq1 equal v_dlambda

variable nadapt equal ${nsteps}/10
variable nadapt equal 1000/10
variable nrepeat equal ${nadapt}/2
variable nrepeat equal 100/2

fix fADAPT all adapt/fep ${nadapt}     pair lj/cut/coul/long sigma 1 3 v_sig13     atom charge 1 v_q1     after yes
fix fADAPT all adapt/fep 100     pair lj/cut/coul/long sigma 1 3 v_sig13     atom charge 1 v_q1     after yes

compute cFEP all fep ${temp}     pair lj/cut/coul/long sigma 1 3 v_dsig13     atom charge 1 v_dq1
compute cFEP all fep 300     pair lj/cut/coul/long sigma 1 3 v_dsig13     atom charge 1 v_dq1

fix fFEP all ave/time 1 ${nrepeat} ${nadapt} c_cFEP[1] c_cFEP[2] file fepNVT.out
fix fFEP all ave/time 1 50 ${nadapt} c_cFEP[1] c_cFEP[2] file fepNVT.out
fix fFEP all ave/time 1 50 100 c_cFEP[1] c_cFEP[2] file fepNVT.out

# thermo_style multi
thermo_style custom step etotal pe evdwl ecoul elong temp v_lambda v_sig13 v_q1
thermo ${nprint}
thermo 100

# dump dCONF all custom ${ndump} dump.lammpstrj id mol type element x y z ix iy iz
# dump_modify dCONF element Ne H O

# restart ${nrestart} restart.*.lmp

run ${nsteps} post no
run 1000 post no
PPPM initialization ...
  G vector (1/distance) = 0.266541
  grid = 10 10 10
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0275322
  estimated relative force accuracy = 8.29123e-05
  using double precision FFTs
  3d grid and FFT values/proc = 3468 500
FEP settings ...
  temperature = 300.000000
  tail no
  lj/cut/coul/long sigma 1-1 3-3
  1-1 charge
Memory usage per processor = 7.05477 Mbytes
Step TotEng PotEng E_vdwl E_coul E_long Temp lambda sig13 q1 
       0   -2000.7075   -2375.9175    444.27231    8806.8609   -11627.051    291.37777            0         2.78            0 
     100   -1992.1704   -2372.8127    475.89931    8774.5751   -11623.287    295.59633          0.1        2.835          0.1 
     200   -1972.6456   -2357.4701    415.65769    8855.1644   -11628.292    298.84407          0.2         2.89          0.2 
     300   -1950.3821     -2375.98    473.38262    8777.0151   -11626.378    330.50758          0.3        2.945          0.3 
     400    -1981.358   -2388.2278    503.05255    8737.1068   -11628.387    315.96385          0.4            3          0.4 
     500    -2014.413   -2392.6108    437.71612    8797.6002   -11627.927     293.6979          0.5        3.055          0.5 
     600   -2023.7171   -2407.4793    445.30549    8773.5448    -11626.33    298.01909          0.6         3.11          0.6 
     700   -2020.6316   -2414.2284    481.22996     8732.281   -11627.739    305.65647          0.7        3.165          0.7 
     800    -2030.328   -2378.6185    457.22529    8791.0164    -11626.86    270.47279          0.8         3.22          0.8 
     900    -2025.018     -2386.52    475.83763    8764.9162   -11627.274    280.73243          0.9        3.275          0.9 
    1000   -1998.5087   -2419.7208     452.2352    8755.1529   -11627.109     327.1017            1         3.33            1 
Loop time of 9.87214 on 2 procs for 1000 steps with 649 atoms

# write_restart restart.*.lmp
# write_data data.*.lmp
